{
    "sourceFile": "admin/src/components/User.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1668733508138,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1668733508138,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from 'react'\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport firebase from 'firebase/app';\nimport 'firebase/firestore';\nimport { Paper, Avatar, Divider, CircularProgress, Button, TextField } from '@material-ui/core';\nimport { DataGrid } from '@material-ui/data-grid';\n\nexport default function User(props) {\n    const [user, setUser] = useState([])\n    const [banReason, setBanReason] = useState('')\n    const location = useLocation();\n    const [posts, setPosts] = useState([])\n    useEffect(() => {\n        firebase.firestore()\n            .collection(\"posts\")\n            .doc(props.match.params.id)\n            .collection(\"userPosts\")\n            .onSnapshot((snapshot) => {\n                let result = snapshot.docs.map(doc => {\n                    const data = doc.data();\n                    const id = doc.id;\n                    return { id, ...data }\n                })\n                setPosts(result)\n            })\n    }, [])\n    useEffect(() => {\n        firebase.firestore()\n            .collection(\"users\")\n            .doc(props.match.params.id)\n            .onSnapshot((snapshot) => {\n                if (snapshot.exists) {\n                    let user = snapshot.data();\n                    user.uid = snapshot.id;\n\n                    setUser(user);\n                }\n            })\n    }, [])\n\n    //Ban the user in the database.\n    const banUser = () => {\n        firebase.firestore()\n            .collection(\"users\")\n            .doc(props.match.params.id)\n            .update({\n                banned: true,\n                banDetails: {\n                    banReason: banReason.target.value,\n                    date: firebase.firestore.FieldValue.serverTimestamp()\n                }\n            })\n    }\n    //update the ban status or unban.\n    const unbanUser = () => {\n        firebase.firestore()\n            .collection(\"users\")\n            .doc(props.match.params.id)\n            .update({\n                banned: false,\n                banDetails: {}\n            })\n    }\n    const history = useHistory();\n    const columns = [\n        { field: 'caption', headerName: 'caption', width: 400 },\n\n        { field: 'likesCount', headerName: 'likesCount', width: 130 },\n        { field: 'commentsCount', headerName: 'commentsCount', width: 130 },\n        {\n            field: 'creation', headerName: 'creation', width: 200,\n            valueGetter: (params) =>\n                `${new Date(params.value.seconds * 1000)}`\n        },\n        {\n            field: 'link', headerName: 'Detail', width: 150,\n            renderCell: (params) => (\n                <div>\n                    <Button variant=\"contained\" color=\"primary\" onClick={() => { history.push({ pathname: `/post/${params.row.id}/${props.match.params.id}` }) }}>\n                        View\n                        </Button>\n                </div>\n            ),\n\n        },\n    ];\n\n    if (user.length == 0) {\n        return (\n            <CircularProgress\n                variant=\"indeterminate\"\n                size={40}\n                thickness={4}\n                value={100}\n            />\n        )\n    }\n    return (\n        //Lets an admin modify a specific users profile and information. This also has all the ban methods.\n        <div className=\" row m-5\">\n\n            <Paper className=\"col-md-3 m-3\" elevation={5}>\n                <div style={{ alignItems: 'center' }} className=\"p-5 \">\n                    <Avatar style={{ height: '200px', width: '200px' }} className=\"m-auto mb-4\" alt=\"Travis Howard\" src={user.image} />\n                    <h3 style={{ textAlign: 'center' }} className=\"mt-4\">{user.name}</h3>\n                    <h6 style={{ textAlign: 'center' }}>{user.username}</h6>\n                </div>\n            </Paper>\n\n\n            <Paper className=\"col-md-8 m-3\" elevation={5}>\n                <div style={{ alignItems: 'center' }} className=\"p-5 \">\n\n                    <p style={{ textAlign: 'left', fontWeight: 'bold' }}>email</p>\n                    <p style={{ textAlign: 'left' }}>{user.email}</p>\n\n\n                    <Divider className=\"mb-3\" />\n                </div>\n            </Paper>\n\n            <Paper className=\"col-md-3 m-3 p-5\" elevation={5}>\n                {!user.banned ?\n                    <div>\n                        <TextField\n                            className=\"col-md-12\"\n                            id=\"outlined-required\"\n                            label=\"Ban Reason\"\n                            defaultValue=\"\"\n                            multiline={true}\n                            variant=\"outlined\"\n                            inputMode=\"numeric\"\n                            onChange={setBanReason}\n                        />\n\n                        <Button className=\"col-md-12 mt-5\" variant=\"contained\" color=\"secondary\" onClick={() => banUser()}>Ban</Button>\n\n                    </div>\n                    :\n                    <div>\n                        <Button className=\"col-md-12 mt-5\" variant=\"contained\" color=\"secondary\" onClick={() => unbanUser()}>Unban</Button>\n\n                    </div>\n                }\n            </Paper>\n\n            <Paper className=\"col-md-8 m-3 p-5\" elevation={5} style={{height: 400}}>\n                <DataGrid rows={posts} columns={columns} pageSize={5} column={columns.map((column) => ({\n                    ...column,\n                    disableClickEventBubbling: true,\n                }))} />\n            </Paper>\n        </div>\n    )\n}"
        }
    ]
}